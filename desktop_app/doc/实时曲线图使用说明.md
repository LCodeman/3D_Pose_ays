# 实时曲线图使用说明 📊

## 功能概述

桌面应用新增了3个实时曲线图窗口，用于可视化传感器数据和姿态角的实时变化：

1. **加速度计曲线** - 显示X、Y、Z三轴加速度（单位：g）
2. **陀螺仪曲线** - 显示X、Y、Z三轴角速度（单位：°/s）
3. **姿态角曲线** - 显示Roll、Pitch、Yaw三个姿态角（单位：°）

---

## 使用方法

### 1. 打开曲线图

**方式一：通过菜单栏**
```
菜单栏 → 视图 → 实时曲线图 → [选择要显示的曲线图]
```

**方式二：使用快捷键（可扩展）**
- 勾选任意一个曲线图选项，对应窗口将在左侧显示

### 2. 窗口布局

- **默认位置**：所有曲线图默认停靠在窗口左侧
- **排列方式**：从上到下依次为：
  1. 加速度计曲线（顶部）
  2. 陀螺仪曲线（中部）
  3. 姿态角曲线（底部）

### 3. 窗口操作

#### 🔄 拖动停靠
- 点击曲线图窗口的**标题栏**（如"加速度计曲线"）
- 拖动到任意位置：
  - **左侧/右侧边缘** → 停靠到侧边
  - **顶部/底部边缘** → 停靠到顶部/底部
  - **悬空** → 浮动窗口（可自由移动）

#### 📏 调整大小
- 拖动窗口边缘调整宽度/高度
- 默认宽度范围：300-500像素
- 可以根据需要调整到更大或更小

#### ❌ 关闭窗口
- 点击窗口右上角的关闭按钮
- 或在菜单中取消勾选对应项

---

## 曲线图详解

### 📈 加速度计曲线

**显示内容：**
- 🔴 **X轴** - 红色曲线
- 🟢 **Y轴** - 青色曲线
- 🔵 **Z轴** - 浅青色曲线

**数值范围：**
- Y轴：-2g 到 +2g
- X轴：最近10秒的数据

**应用场景：**
- 监测设备倾斜状态
- 检测震动和冲击
- 分析重力分量

**示例解读：**
```
静止水平放置: X≈0, Y≈0, Z≈1g
垂直向上:      X≈0, Y≈0, Z≈0
倒置:          X≈0, Y≈0, Z≈-1g
```

---

### 🔄 陀螺仪曲线

**显示内容：**
- 🔴 **X轴** - 红色曲线（横滚角速度）
- 🟢 **Y轴** - 青色曲线（俯仰角速度）
- 🔵 **Z轴** - 浅青色曲线（偏航角速度）

**数值范围：**
- Y轴：-200°/s 到 +200°/s
- X轴：最近10秒的数据

**应用场景：**
- 监测旋转速度
- 检测突然转动
- 分析运动平滑性

**示例解读：**
```
静止:         X≈0, Y≈0, Z≈0
快速旋转:     对应轴显示大值（±100°/s以上）
匀速转动:     对应轴显示稳定数值
```

---

### 📐 姿态角曲线

**显示内容：**
- 🔴 **Roll**（横滚） - 红色曲线
- 🟢 **Pitch**（俯仰） - 青色曲线
- 🟡 **Yaw**（偏航） - 黄色曲线

**数值范围：**
- Y轴：-180° 到 +180°
- X轴：最近10秒的数据

**应用场景：**
- 监测整体姿态
- 观察姿态稳定性
- 分析姿态变化趋势

**示例解读：**
```
水平放置:     Roll≈0°, Pitch≈0°
向右倾斜45°:  Roll≈45°, Pitch≈0°
抬头45°:      Roll≈0°, Pitch≈45°
顺时针转90°:  Yaw≈90°（相对起始位置）
```

---

## 高级功能

### 🎨 图表特性

1. **自动缩放**
   - X轴自动滚动，始终显示最近10秒
   - Y轴根据数据范围自动调整（部分图表固定范围）

2. **数据缓冲**
   - 每个曲线图最多保存100个数据点
   - 采样率：100ms（10Hz）
   - 总时长：约10秒

3. **颜色编码**
   - 使用不同颜色区分三个轴
   - 深色主题，保护眼睛
   - 半透明网格，清晰易读

4. **图例说明**
   - 右上角显示图例
   - 快速识别各曲线含义

### 📊 布局组合推荐

**场景一：全面监控**
```
打开所有3个曲线图，垂直堆叠在左侧
适合：详细分析和调试
```

**场景二：重点观察**
```
只打开姿态角曲线图
适合：关注最终姿态结果
```

**场景三：对比分析**
```
加速度计和陀螺仪并排显示
一个在左侧，一个在右侧
适合：对比原始数据
```

---

## 实用技巧

### 💡 最佳实践

1. **初始设置**
   - 首次使用建议打开所有曲线图
   - 观察数据后决定保留哪些

2. **性能优化**
   - 不需要时关闭曲线图可节省CPU
   - matplotlib渲染有一定开销

3. **数据分析**
   - 观察曲线平滑度判断传感器质量
   - 注意是否有异常尖峰
   - 检查Yaw角是否漂移

4. **窗口布局**
   - 可以保存窗口布局（Qt自动）
   - 下次启动恢复之前的配置

### 🐛 故障排查

**问题：曲线图不更新**
- 检查是否已连接设备
- 查看状态栏是否显示"连接正常"
- 尝试断开重连

**问题：曲线图卡顿**
- 关闭不需要的曲线图
- 检查CPU占用
- 降低采样频率（需修改代码）

**问题：数值异常**
- 检查传感器是否正常工作
- 查看原始数据显示面板
- 尝试重置姿态

---

## 技术细节

### 📦 依赖库

- **matplotlib** - 绘图库
- **PyQt5** - GUI框架
- **numpy** - 数值计算

### 🔧 代码结构

```
desktop_app/
├── ui/
│   ├── realtime_plot.py      # 曲线图组件
│   │   ├── RealtimePlotWidget      # 基础曲线图类
│   │   ├── AccelerometerPlot       # 加速度计曲线
│   │   ├── GyroscopePlot           # 陀螺仪曲线
│   │   └── AttitudePlot            # 姿态角曲线
│   └── main_window.py        # 主窗口（集成曲线图）
```

### ⚙️ 自定义配置

如需修改参数，编辑 `realtime_plot.py`：

```python
# 修改数据点数量（默认100）
max_points=150

# 修改Y轴范围
y_range=(-5, 5)  # 加速度范围改为±5g

# 修改曲线颜色
colors=['#ff0000', '#00ff00', '#0000ff']
```

---

## 快速参考

| 操作 | 方法 |
|------|------|
| 打开曲线图 | 菜单 → 视图 → 实时曲线图 → 勾选 |
| 关闭曲线图 | 点击窗口关闭按钮 或 取消菜单勾选 |
| 拖动窗口 | 拖动标题栏到目标位置 |
| 调整大小 | 拖动窗口边缘 |
| 浮动窗口 | 拖离停靠区域 |
| 重新停靠 | 拖到窗口边缘 |

---

## 常见问题（FAQ）

**Q: 曲线图可以同时显示吗？**
A: 是的，3个曲线图可以同时显示，互不影响。

**Q: 可以导出曲线图数据吗？**
A: 当前版本不支持，未来可能添加导出功能。

**Q: 曲线图能保存为图片吗？**
A: 可以使用截图工具，或添加右键菜单"保存为图片"功能。

**Q: 为什么Yaw角一直在变？**
A: 没有磁力计时，Yaw角通过陀螺仪积分计算，会有漂移，这是正常现象。

**Q: 曲线图最多显示多长时间？**
A: 默认10秒（100个点×100ms），可通过修改`max_points`参数调整。

---

## 版本历史

- **v2.0** (2025-10) - 新增实时曲线图功能
  - 支持3种曲线图
  - 可拖动停靠窗口
  - 深色主题
  - 实时数据更新

---

## 反馈与建议

如有问题或建议，欢迎反馈！

**希望改进的功能：**
- [ ] 数据导出（CSV/Excel）
- [ ] 曲线图截图保存
- [ ] 暂停/继续功能
- [ ] 标记重要时刻
- [ ] 时间轴缩放

---

*最后更新：2025年10月*

